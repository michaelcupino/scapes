{% extends "templates/defaultLayout.html" %}
{% block head %}
  <script src="/js/processing-1.3.6.min.js"></script>
{% endblock %}
{% block content %}

  <script type="text/javascript">
    setRevisionCount({{ revisionCount }});
  </script>
  <h1>Analysis of Document</h2>

  <h2>Mocked Revision History Visualilzation</h2>
  <div class="visualization">
    <div class="visualization-info">
      <p class="user1">Michael</p>
      <p class="user2">Grace</p>
      <p class="user3">Danielle</p>
    </div>
    <canvas data-processing-sources="/pde/docsRevision.pde"></canvas>
  </div>

  <h2>Document Tags</h2>
  {% for documentTag in documentTags %}
    <div class="document-tag">
      {{ documentTag.content|escape }}
    </div>
  {% endfor %}
  <form action="/tagDocument" method="post">
    <div><textarea name="content" rows="3" cols="60"></textarea></div>
    <div><input type="submit" value="Add Tag"></div>
  </form>
  
  <h2>Mock Data Table </h2>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Time</th>
        <th>Who in doc</th>
        <th>Words added</th>
        <th>Words deleted</th>
        <th>Punct. cap</th>
        <th>Words moved</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>18-Sep</td>
        <td>3:05PM</td>
        <td>ME(red)</td>
        <td>1358</td>
        <td></td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td>19-Sep</td>
        <td>4:53PM</td>
        <td>ME(red)</td>
        <td>2</td>
        <td>3</td>
        <td>1</td>
        <td></td>
      </tr>
      <tr>
        <td>19-Sep</td>
        <td>7:02AM</td>
        <td>ME(red)</td>
        <td>313</td>
        <td>20</td>
        <td>2</td>
        <td></td>
      </tr>
    </tbody>
    <tfoot>
    </tfoot>
  </table>

  <h2>Raw Diffs</h2>
  <div class="raw-diffs">
    {% for revisionValues in valuesOfRevisions %}
      <div class="diff">
        <h3>{{ revisionValues['revisionTitle'] }}, Author: {{ revisionValues['author'] }}, Last Edited: {{ revisionValues['lastEdit'] }}</h3>
        <p>Total word count: {{ revisionValues['revisionWordCount'] }}, Words Added: , Words Deleted: </p>
        <pre>
          {# TODO(someone?) Figure out why you have to decode #}
          {{ revisionValues['currentDiff'].decode("utf-8") }}
        </pre>
      </div>
    {% endfor %}
  </div>
{% endblock %}
